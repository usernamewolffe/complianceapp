{# ui/templates/ui/partials/_site_create_form.html #}
{# expects: org, form (SiteForm) #}

<form method="post"
      hx-post="{% url 'orgs:site-create' org_id=org.id %}"
      hx-target="#site-create-modal-content"   {# invalid -> re-render here #}
      hx-swap="innerHTML">
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger" style="margin-bottom:.75rem">
      {{ form.non_field_errors }}
    </div>
  {% endif %}

  <fieldset style="margin:0;padding:0;border:0">
    <legend style="font-weight:600;margin-bottom:.5rem">Site details</legend>
    <div class="grid" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="field">
        <label for="{{ form.name.id_for_label }}">Site name *</label>
        {{ form.name }}
        {% if form.name.errors %}<div class="error">{{ form.name.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.timezone.id_for_label }}">Time zone</label>
        {{ form.timezone }}
        {% if form.timezone.errors %}<div class="error">{{ form.timezone.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.essential_service.id_for_label }}">Essential service (Annex E) *</label>
        {{ form.essential_service }}
        {% if form.essential_service.errors %}<div class="error">{{ form.essential_service.errors }}</div>{% endif %}
        <small class="hint">e.g. Electricity transmission, Distribution, CHP, etc.</small>
      </div>

      <div class="field">
        <label for="{{ form.network_role.id_for_label }}">Network role / subtype (Annex E) *</label>
        {{ form.network_role }}
        {% if form.network_role.errors %}<div class="error">{{ form.network_role.errors }}</div>{% endif %}
        <small class="hint">Use your organisationâ€™s taxonomy you map into Annex E.</small>
      </div>

      <div class="field">
        <label for="{{ form.eic_code.id_for_label }}">EIC code (if applicable)</label>
        {{ form.eic_code }}
        {% if form.eic_code.errors %}<div class="error">{{ form.eic_code.errors }}</div>{% endif %}
      </div>
      <div></div>

      <div class="field" style="grid-column:1/-1">
        <label for="{{ form.address_line1.id_for_label }}">Address line 1 *</label>
        {{ form.address_line1 }}
        {% if form.address_line1.errors %}<div class="error">{{ form.address_line1.errors }}</div>{% endif %}
      </div>

      <div class="field" style="grid-column:1/-1">
        <label for="{{ form.address_line2.id_for_label }}">Address line 2</label>
        {{ form.address_line2 }}
        {% if form.address_line2.errors %}<div class="error">{{ form.address_line2.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.city.id_for_label }}">Town/City *</label>
        {{ form.city }}
        {% if form.city.errors %}<div class="error">{{ form.city.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.postcode.id_for_label }}">Postcode *</label>
        {{ form.postcode }}
        {% if form.postcode.errors %}<div class="error">{{ form.postcode.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.country_code.id_for_label }}">Country (ISO-2) *</label>
        {{ form.country_code }}
        {% if form.country_code.errors %}<div class="error">{{ form.country_code.errors }}</div>{% endif %}
      </div>
      <div></div>
    </div>
  </fieldset>

  <fieldset style="margin-top:1rem;padding:0;border:0">
    <legend style="font-weight:600;margin-bottom:.5rem">Primary contact (Annex E)</legend>
    <div class="grid" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="field">
        <label for="{{ form.contact_name.id_for_label }}">Name *</label>
        {{ form.contact_name }}
        {% if form.contact_name.errors %}<div class="error">{{ form.contact_name.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.contact_role.id_for_label }}">Role *</label>
        {{ form.contact_role }}
        {% if form.contact_role.errors %}<div class="error">{{ form.contact_role.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.contact_email.id_for_label }}">Email *</label>
        {{ form.contact_email }}
        {% if form.contact_email.errors %}<div class="error">{{ form.contact_email.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.contact_phone.id_for_label }}">Phone *</label>
        {{ form.contact_phone }}
        {% if form.contact_phone.errors %}<div class="error">{{ form.contact_phone.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.ooh_phone.id_for_label }}">Out-of-hours phone</label>
        {{ form.ooh_phone }}
        {% if form.ooh_phone.errors %}<div class="error">{{ form.ooh_phone.errors }}</div>{% endif %}
      </div>

      <div class="field">
        <label for="{{ form.dpo_email.id_for_label }}">DPO / privacy email</label>
        {{ form.dpo_email }}
        {% if form.dpo_email.errors %}<div class="error">{{ form.dpo_email.errors }}</div>{% endif %}
      </div>
    </div>
  </fieldset>

  <div style="display:flex;gap:.5rem;justify-content:flex-end;margin-top:12px">
    <button type="submit" class="btn btn-primary">Create site</button>
    <button type="button" class="btn" onclick="document.getElementById('site-create-modal').close()">Cancel</button>
  </div>

  <style>
    .field label { display:block; font-size:.9rem; color:#555; margin-bottom:4px; }
    .field input, .field select { width:100%; padding:.5rem; border:1px solid #ced4da; border-radius:.5rem; }
    .error { color:#b91c1c; font-size:.85rem; margin-top:4px; }
    .hint { display:block; color:#666; font-size:.8rem; margin-top:4px; }
  </style>
</form>
